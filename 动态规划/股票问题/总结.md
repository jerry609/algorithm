## 买卖股票的最佳时机
因为只让买入和卖出一次，所以就是要找最小的买入点和最大的卖出点，所以每次递推的时候就是找最小买入点和最大卖出点，每个前一个节点都应该是最好的选择
### dp表
$dp[i][0]$ 表示第i天持有股票所得最多现金 ，**这里可能有同学疑惑，本题中只能买卖一次，持有股票之后哪还有现金呢？**
其实一开始现金是0，那么加入第i天买入股票现金就是 -prices[i]， 这是一个负数。
$dp[i][1]$ 表示第i天不持有股票所得最多现金
**注意这里说的是“持有”，“持有”不代表就是当天“买入”！也有可能是昨天就买入了，今天保持持有的状态**
很多同学把“持有”和“买入”没区分清楚。
在下面递推公式分析中，我会进一步讲解。
### 状态转移方程
如果第i天持有股票即dp[i][0]， 那么可以由两个状态推出来
- 第i-1天就持有股票，那么就保持现状，所得现金就是昨天持有股票的所得现金 即：$dp[i - 1][0]$
- 第i天买入股票，所得现金就是买入今天的股票后所得现金即：-prices[i]
那么$dp[i][0]$应该选所得现金最大的，所以$dp[i][0] = max(dp[i - 1][0], -prices[i])$;
如果第i天不持有股票即$dp[i][1]$， 也可以由两个状态推出来
- 第i-1天就不持有股票，那么就保持现状，所得现金就是昨天不持有股票的所得现金 即：$dp[i - 1][1]$
- 第i天卖出股票，所得现金就是按照今天股票价格卖出后所得现金即：prices[i] + $dp[i - 1][0]$
同样$dp[i][1]$取最大的，$dp[i][1] = max(dp[i - 1][1], prices[i] + dp[i - 1][0])$;

## 买卖股票的最佳时机II
这里重申一下dp数组的含义：
- $dp[i][0]$ 表示第i天持有股票所得现金。
- $dp[i][1]$ 表示第i天不持有股票所得最多现金

如果第i天持有股票即$dp[i][0]$， 那么可以由两个状态推出来
- 第i-1天就持有股票，那么就保持现状，所得现金就是昨天持有股票的所得现金 即：$dp[i - 1][0]$
- 第i天买入股票，所得现金就是昨天不持有股票的所得现金减去 今天的股票价格 即：$dp[i - 1][1] - prices[i]$

**注意这里和[121. 买卖股票的最佳时机 (opens new window)](https://programmercarl.com/0121.%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA.html)唯一不同的地方，就是推导$dp[i][0]$的时候，第i天买入股票的情况**。

在[121. 买卖股票的最佳时机 (opens new window)](https://programmercarl.com/0121.%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA.html)中，因为股票全程只能买卖一次，所以如果买入股票，那么第i天持有股票即$dp[i][0]$一定就是 -$prices[i]$。

而本题，因为一只股票可以买卖多次，所以当第i天买入股票的时候，所持有的现金可能有之前买卖过的利润。

那么第i天持有股票即$dp[i][0]$，如果是第i天买入股票，所得现金就是昨天不持有股票的所得现金 减去 今天的股票价格 即：$dp[i - 1][1] - prices[i]$。

再来看看如果第i天不持有股票即dp[i][1]的情况， 依然可以由两个状态推出来
- 第i-1天就不持有股票，那么就保持现状，所得现金就是昨天不持有股票的所得现金 即：$dp[i - 1][1]$
- 第i天卖出股票，所得现金就是按照今天股票价格卖出后所得现金即：$prices[i] + dp[i - 1][0]$

## 买卖股票的最佳时机III
1. 确定dp数组以及下标的含义

一天一共就有五个状态，

0. 没有操作 （其实我们也可以不设置这个状态）
1. 第一次持有股票
2. 第一次不持有股票
3. 第二次持有股票
4. 第二次不持有股票

$dp[i][j]$中 i表示第i天，j为 [0 - 4] 五个状态，$dp[i][j]$表示第i天状态j所剩最大现金。

需要注意：$dp[i][1]$，**表示的是第i天，买入股票的状态，并不是说一定要第i天买入股票，这是很多同学容易陷入的误区**。

例如 $dp[i][1]$ ，并不是说 第i天一定买入股票，有可能 第 i-1天 就买入了，那么 $dp[i][1]$ 延续买入股票的这个状态。

2. 确定递推公式

达到dp[i][1]状态，有两个具体操作：

- 操作一：第i天买入股票了，那么$dp[i][1] = dp[i-1][0] - prices[i]$
- 操作二：第i天没有操作，而是沿用前一天买入的状态，即：$dp[i][1] = dp[i - 1][1]$

那么$dp[i][1]$究竟选 $dp[i-1][0] - prices[i]$，还是$dp[i - 1][1]$呢？

一定是选最大的，所以 $dp[i][1] = max(dp[i-1][0] - prices[i], dp[i - 1][1])$;

同理$dp[i][2]$也有两个操作：

- 操作一：第i天卖出股票了，那么$dp[i][2] = dp[i - 1][1] + prices[i]$
- 操作二：第i天没有操作，沿用前一天卖出股票的状态，即：$dp[i][2] = dp[i - 1][2]$

所以$dp[i][2] = max(dp[i - 1][1] + prices[i], dp[i - 1][2])$

同理可推出剩下状态部分：

$dp[i][3] = max(dp[i - 1][3], dp[i - 1][2] - prices[i])$;

$dp[i][4] = max(dp[i - 1][4], dp[i - 1][3] + prices[i])$;

## 买卖股票的最佳时机IV
## dp表


## 状态转移方程


## 最佳买卖股票时机含冷冻期
## dp表


## 状态转移方程


## 买卖股票的最佳时机含手续费
## dp表


## 状态转移方程
